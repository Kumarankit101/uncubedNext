import React, { useEffect, useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

interface LoadingScreenProps {
  onComplete?: () => void;
  minDuration?: number; // Minimum loading time in ms
}

export const LoadingScreen: React.FC<LoadingScreenProps> = ({ 
  onComplete, 
  minDuration = 2000 
}) => {
  const [isLoading, setIsLoading] = useState(true);
  const [showContent, setShowContent] = useState(false);

  useEffect(() => {
    const startTime = Date.now();

    const checkLoadingComplete = () => {
      const elapsed = Date.now() - startTime;
      const remainingTime = Math.max(0, minDuration - elapsed);

      setTimeout(() => {
        setIsLoading(false);
        setTimeout(() => {
          onComplete?.();
        }, 800); // Wait for fade out animation
      }, remainingTime);
    };

    // Check if page is already loaded
    if (document.readyState === 'complete') {
      checkLoadingComplete();
    } else {
      window.addEventListener('load', checkLoadingComplete);
      return () => window.removeEventListener('load', checkLoadingComplete);
    }

    // Show content after a brief delay
    const contentTimer = setTimeout(() => setShowContent(true), 300);
    return () => clearTimeout(contentTimer);
  }, [minDuration, onComplete]);

  return (
    <AnimatePresence>
      {isLoading && (
        <motion.div
          initial={{ opacity: 1 }}
          exit={{ opacity: 0 }}
          transition={{ duration: 0.8, ease: "easeInOut" }}
          className="fixed inset-0 z-[9999] bg-black flex items-center justify-center"
        >
          {/* Grid background */}
          <div className="absolute inset-0 opacity-20">
            <div className="absolute inset-0 bg-[linear-gradient(to_right,#ffffff08_1px,transparent_1px),linear-gradient(to_bottom,#ffffff08_1px,transparent_1px)] bg-[size:60px_60px]" />
          </div>

          {/* Gradient effects */}
          <div className="absolute inset-0">
            <div className="absolute inset-0 bg-[radial-gradient(circle_at_30%_20%,rgba(59,130,246,0.15),transparent_50%)]" />
            <div className="absolute inset-0 bg-[radial-gradient(circle_at_70%_80%,rgba(139,92,246,0.15),transparent_50%)]" />
          </div>

          {/* Main content */}
          <div className="relative z-10 flex items-center justify-center">
            <AnimatePresence>
              {showContent && (
                <motion.div
                  initial={{ opacity: 0, scale: 0.8 }}
                  animate={{ opacity: 1, scale: 1 }}
                  transition={{ duration: 0.6, ease: "easeOut" }}
                  className="flex items-center gap-1"
                >
                  {/* Letters before cube */}
                  <div className="flex">
                    {['U', 'n', 'C'].map((letter, index) => (
                      <motion.span
                        key={`before-${index}`}
                        initial={{ opacity: 0, y: 20 }}
                        animate={{ opacity: 1, y: 0 }}
                        transition={{ 
                          duration: 0.6, 
                          delay: 0.2 + index * 0.1,
                          ease: "easeOut"
                        }}
                        className="text-6xl md:text-7xl lg:text-8xl font-bold text-white"
                      >
                        {letter}
                      </motion.span>
                    ))}
                  </div>

                  {/* Animated Logo */}
                  <motion.div
                    initial={{ opacity: 0, scale: 0, rotateY: 0 }}
                    animate={{ 
                      opacity: 1, 
                      scale: 1, 
                      rotateY: 360,
                    }}
                    transition={{ 
                      opacity: { duration: 0.4, delay: 0.5 },
                      scale: { duration: 0.6, delay: 0.5, ease: "easeOut" },
                      rotateY: { 
                        duration: 3, 
                        delay: 0.8, 
                        repeat: Infinity, 
                        ease: "linear" 
                      }
                    }}
                    className="mx-2 relative"
                    style={{ perspective: '1000px' }}
                  >
                    <div className="w-12 h-12 md:w-14 md:h-14 lg:w-16 lg:h-16 relative">
                      <svg width="100%" height="100%" viewBox="0 0 503 567" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fillRule="evenodd" clipRule="evenodd" d="M66.6332 107.982L66.6121 107.974C65.3142 107.499 64.0163 107.023 62.7184 106.548C64.0233 107.026 65.3283 107.504 66.6332 107.982Z" fill="white"/>
                        <path fillRule="evenodd" clipRule="evenodd" d="M0.479494 248.308C0.566746 273.359 0.654205 298.469 0 323.765C0.0494652 325.885 0.113419 327.957 0.176395 329.996C0.295169 333.844 0.410469 337.579 0.418542 341.314C0.431434 347.283 0.45237 353.252 0.473305 359.221C0.551096 381.4 0.628891 403.581 0.294057 425.755C0.203888 431.728 2.73512 434.706 7.97445 437.391C26.2186 446.742 44.3586 456.262 62.4227 465.895C124.362 498.922 186.277 531.985 248.104 565.184C252.584 567.59 255.95 567.635 260.355 565.14C300.837 542.213 341.417 519.43 382.008 496.66C420.479 475.078 458.96 453.508 497.548 432.096C501.644 429.824 503.005 427.261 503 423.008C502.897 327.36 502.902 231.712 502.908 136.063C502.909 122.581 502.91 109.099 502.91 95.617V95.5421C502.91 86.7405 502.91 86.7061 493.746 83.5076C448.269 67.6337 402.787 51.7711 357.304 35.9112C348.257 32.7565 339.208 29.6061 330.159 26.4557L330.149 26.452L330.138 26.4483L330.128 26.4446L330.096 26.4336C306.095 18.0774 282.094 9.7212 258.127 1.28593C253.512 -0.338267 249.419 -0.498938 244.707 1.23562C235.436 4.64906 226.077 7.86892 216.718 11.0889L216.716 11.0895C211.926 12.7376 207.136 14.3858 202.357 16.0599C185.118 22.0991 167.881 28.142 150.644 34.1848L150.55 34.2177L150.503 34.2342L150.484 34.2409L150.481 34.242C102.626 51.0186 54.7714 67.7952 6.88338 84.4943C2.16677 86.1389 0.328739 88.3506 0.352837 93.0803C0.557517 133.269 0.545743 173.46 0.43175 213.65C0.399 225.198 0.439225 236.747 0.479494 248.308ZM127.157 186.527C127.157 179.339 127.157 179.336 134.946 176.865C142.11 174.962 148.965 172.568 155.751 170.199C165.854 166.67 175.804 163.196 186.393 161.474C178.669 166.107 170.27 169.389 161.889 172.663C160.701 173.127 159.513 173.591 158.328 174.058C151.628 176.702 144.725 178.953 137.815 181.126C134.723 182.098 133.386 183.425 133.391 186.583C133.426 207.076 133.326 227.571 133.226 248.067C133.01 292.168 132.794 336.27 133.925 380.343C135.014 422.757 160.903 462.397 213.3 474.995C222.983 477.322 232.848 478.604 242.886 478.173C246.94 477.997 248.504 479.212 248.477 483.034C248.378 497.09 248.376 511.146 248.373 525.202V525.209C248.372 533.132 248.37 541.055 248.351 548.978C248.348 550.242 248.18 551.505 247.978 553.026C247.873 553.817 247.758 554.678 247.653 555.645L14.6142 431.374C15.5719 429.693 17.0115 429.16 18.3759 428.656C18.6905 428.54 19.0011 428.425 19.3009 428.297C25.0514 425.858 30.8076 423.429 36.5639 421.001L36.57 420.998L36.5772 420.995L36.5854 420.992L36.5947 420.988L36.607 420.983L36.6164 420.979L36.6255 420.975C49.4059 415.583 62.1862 410.191 74.9026 404.679C78.413 403.157 80.1531 403.71 82.0385 406.626C94.6034 426.059 113.245 439.235 135.577 448.463C143.172 451.601 150.827 454.62 158.483 457.639L158.496 457.645L158.504 457.648C161.825 458.958 165.147 460.268 168.464 461.588L168.507 461.605L168.553 461.624L168.636 461.658L168.721 461.694L168.725 461.696C169.534 462.035 170.388 462.394 171.752 461.473C170.52 460.38 169.28 459.301 168.042 458.225L168.041 458.223C164.16 454.847 160.308 451.495 156.812 447.826C139.856 430.027 130.732 409.364 127.97 386.123C127.255 380.102 127.19 374.124 127.186 368.12C127.161 322.979 127.16 277.839 127.159 232.698V232.337C127.159 217.074 127.159 201.81 127.157 186.547V186.527ZM329.136 449.842C307.62 462.847 284.508 472.505 258.951 476.92C255.7 477.481 254.054 478.377 254.074 481.766C254.163 497.322 254.158 512.878 254.153 528.434C254.15 536.8 254.147 545.166 254.159 553.532C254.159 553.554 254.159 553.576 254.159 553.598L254.158 553.645C254.157 553.713 254.156 553.782 254.154 553.851C254.15 553.974 254.145 554.098 254.14 554.223C254.085 555.599 254.026 557.075 255.89 558.222C256.49 557.904 257.101 557.586 257.719 557.264L257.72 557.263C259.052 556.569 260.414 555.86 261.748 555.111C271.376 549.709 281 544.3 290.623 538.892L290.886 538.744C297.711 534.908 304.535 531.072 311.362 527.239C327.405 518.23 343.448 509.222 359.491 500.214L362.65 498.441C404.936 474.697 447.223 450.954 489.501 427.2C494.128 424.6 494.919 422.206 489.273 419.332C489.118 419.254 469.94 412.716 449.275 405.671L449.236 405.658L449.223 405.654L449.132 405.623L449.027 405.587L449.015 405.583C424.917 397.368 398.898 388.498 398.718 388.395C397.231 387.548 395.637 386.64 393.05 386.92C377.722 416.654 361.352 431.334 329.136 449.842ZM66.2718 117.489C66.2935 114.983 65.3713 113.78 62.7789 112.855C51.4438 108.812 40.1436 104.688 28.8434 100.565L28.8372 100.562L28.8322 100.561C23.7908 98.721 18.7494 96.8813 13.7049 95.0488C13.4953 94.9727 13.2861 94.8857 13.0744 94.7976C11.9497 94.3298 10.7559 93.8333 9.06577 94.7913V94.848C9.06577 124.964 9.06577 155.308 9.06425 186.555C9.05983 191.295 9.08558 269.332 9.08795 274.182C9.09026 280.029 9.06024 288.843 9.02804 298.294C8.97819 312.927 8.92314 329.089 8.97479 338.142C9.11962 350.064 9.10065 361.988 9.08168 373.912C9.07143 380.353 9.06118 386.795 9.07676 393.236C9.10147 403.466 9.26167 413.695 9.73619 424.505C11.0351 425.31 12.1493 424.764 13.209 424.245L13.21 424.245C13.4427 424.131 13.6728 424.018 13.9017 423.922C20.5941 421.089 27.279 418.241 33.9637 415.393L33.9821 415.386L34.0017 415.377C46.2769 410.148 58.5521 404.919 70.8744 399.782C75.1395 398.004 75.8187 395.96 74.1769 392.037C69.2674 380.306 66.7901 368.149 66.3468 355.527C66.0597 347.354 66.0237 339.185 65.9876 331.016V331.015V331.013C65.9672 326.395 65.9469 321.777 65.8811 317.159C65.7805 301.883 65.9972 221.64 66.1458 166.635C66.2066 144.13 66.256 125.85 66.2675 117.974L66.2675 117.972L66.2718 117.489ZM397.661 376.586C403.13 359.704 403.635 358.067 405.793 312.433C405.698 281.122 405.65 160.095 405.672 128.784C405.66 126.282 406.237 124.444 409.081 123.444C425.77 117.566 442.451 111.669 459.133 105.773L459.149 105.767L459.181 105.756L459.203 105.748L459.224 105.74L459.246 105.733L459.264 105.726L459.282 105.72L459.299 105.714L459.317 105.708L459.335 105.701C470.003 101.93 480.672 98.1591 491.342 94.3929C491.747 94.2502 492.195 94.2081 492.64 94.1662C492.846 94.1469 493.051 94.1276 493.25 94.0984C494.548 95.2213 494.432 96.5431 494.321 97.8088C494.29 98.1612 494.26 98.5092 494.26 98.8475C494.204 130.306 494.24 224.535 494.266 294.405V294.504C494.278 325.264 494.288 351.292 494.287 365.146V365.642C494.287 380.03 494.286 394.419 494.283 408.807C494.283 409.626 494.206 410.445 494.128 411.264L494.105 411.512C494.096 411.601 494.088 411.69 494.08 411.779C494.061 411.988 494.044 412.197 494.028 412.405C493.594 413.092 493.095 413.624 490.257 413.092C487.097 411.817 463.203 403.54 440.328 395.889L440.324 395.888C419.89 389.054 400.392 382.532 397.661 381.26C395.682 380.338 396.07 379.669 396.764 378.471C397.06 377.96 397.413 377.352 397.661 376.586ZM197.147 350.955C197.145 350.369 197.144 349.771 197.142 349.151C197.122 343.598 197.125 338.045 197.128 332.492C197.13 330.219 197.131 327.947 197.131 325.674C197.13 314.478 197.126 303.32 197.123 292.19L197.123 292.11C197.11 248.21 197.096 204.768 197.242 161.327C197.257 156.931 195.553 155.071 191.24 153.504C149.776 138.44 108.36 123.268 66.9432 108.095L66.8812 108.073L66.8193 108.05L66.7576 108.027L66.6332 107.982L66.6121 107.974L62.7184 106.548C53.584 103.201 44.4494 99.8552 35.3143 96.5104C30.761 94.8433 26.2091 93.1737 21.2226 91.3447L21.2023 91.3373L15.8981 89.3919C93.5015 61.8291 170.273 35.0925 247.162 8.73362C252 7.07504 256.273 8.95535 256.273 8.95535L404.66 60.5852L422.762 66.8836L423.511 67.1441L485.791 88.8138C484.602 90.4936 482.974 90.9007 481.454 91.2809C480.943 91.4087 480.444 91.5335 479.977 91.7027C470.046 95.3054 460.105 98.8865 450.164 102.468L450.137 102.477L450.134 102.479L450.131 102.48L450.127 102.481L450.124 102.482L450.121 102.483L450.117 102.485L450.114 102.486L450.111 102.487L450.107 102.488L450.104 102.489L450.101 102.491L450.098 102.492L450.094 102.493L450.091 102.494L450.088 102.495L450.084 102.497L450.081 102.498C435.779 107.65 421.476 112.802 407.202 118.019C403.718 119.292 400.73 119.415 397.223 118.094C390.739 115.648 384.212 113.297 377.685 110.946L377.684 110.946L377.682 110.945C372.15 108.952 366.619 106.96 361.114 104.91C358.449 103.918 356.172 103.93 353.514 104.886C336.661 110.949 319.784 116.956 302.844 122.815C299.327 124.031 298.152 125.822 298.216 129.195C298.374 137.587 298.347 145.983 298.32 154.378V154.382C298.31 157.578 298.3 160.775 298.3 163.97C298.299 176.804 298.306 189.57 298.312 202.289V202.32V202.352V202.384V202.415V202.447V202.478V202.51V202.541V202.572V202.604V202.635V202.666V202.698V202.729V202.76V202.791V202.822V202.853V202.884V202.915V202.946V202.977V203.008C298.329 236.894 298.346 270.438 298.241 303.982C298.202 316.254 298.037 318.807 297.835 321.927C297.786 322.682 297.735 323.47 297.683 324.436C297.101 335.277 293.956 341.65 291.686 345.214C288.769 349.793 287.292 351.687 286.251 353.022C285.976 353.374 285.732 353.687 285.5 354C269.609 375.427 242.574 388.4 214.67 392.906C220.414 401.114 227.935 405.879 237.253 408.474C248.8 411.689 260.329 410.61 271.662 407.693C301.059 400.125 324.038 385.094 337.786 359.883C343.443 349.506 346.056 338.351 346.059 326.756C346.061 319.022 346.064 311.288 346.067 303.553C346.084 252.578 346.102 201.603 345.96 150.628C345.947 145.905 347.197 143.384 352.491 141.719C355.006 140.927 357.439 139.956 359.875 138.983C361.593 138.297 363.313 137.611 365.063 136.987C371.884 133.91 387.552 127.05 394.549 125.695C393.797 126.08 390.97 127.742 388.195 129.374L388.187 129.378L388.186 129.379L388.179 129.383L388.172 129.387L388.17 129.388L388.168 129.39L388.161 129.394L388.159 129.395L388.158 129.396L388.155 129.397C385.527 130.943 382.955 132.455 382.245 132.824L382.24 132.827C374.72 136.738 367.2 140.649 359.038 143.359C353.948 145.049 352.179 147.636 352.215 152.697C352.421 180.979 352.398 209.26 352.375 237.542C352.368 246.443 352.361 255.344 352.361 264.245C352.362 270.472 352.352 276.608 352.343 282.684C352.323 295.849 352.304 308.724 352.383 321.6C352.628 361.099 330.98 388.103 293.325 405.731C279.296 412.299 264.322 416.067 248.22 415.408C231.242 414.714 218.494 407.491 209.112 395.111C203.327 387.476 199.468 379.025 197.524 369.878C197.17 360.137 197.159 355.974 197.147 350.955Z" fill="white"/>
                      </svg>
                    </div>
                  </motion.div>

                  {/* Letters after cube */}
                  <div className="flex">
                    {[ 'b', 'e', 'd'].map((letter, index) => (
                      <motion.span
                        key={`after-${index}`}
                        initial={{ opacity: 0, y: 20 }}
                        animate={{ opacity: 1, y: 0 }}
                        transition={{ 
                          duration: 0.6, 
                          delay: 0.5 + index * 0.1,
                          ease: "easeOut"
                        }}
                        className="text-6xl md:text-7xl lg:text-8xl font-bold text-white"
                      >
                        {letter}
                      </motion.span>
                    ))}
                  </div>
                </motion.div>
              )}
            </AnimatePresence>

            {/* Loading indicator */}
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 1.5 }}
              className="absolute bottom-20 left-1/2 transform -translate-x-1/2"
            >
              
            </motion.div>
          </div>
        </motion.div>
      )}
    </AnimatePresence>
  );
};